
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
@tailwind base;
@tailwind components;
@tailwind utilities;

/* Ojas Wellness Design System - Enhanced with 4pt Grid & Typography Hierarchy */

@layer base {
  :root {
    --background: 245 248 250; /* ojas-mist-white */
    --foreground: 34 41 47; /* ojas-charcoal-gray */

    --card: 255 255 255;
    --card-foreground: 34 41 47;

    --popover: 255 255 255;
    --popover-foreground: 34 41 47;

    --primary: 0 119 182; /* ojas-primary-blue */
    --primary-foreground: 255 255 255;

    --secondary: 225 228 234; /* ojas-cloud-silver */
    --secondary-foreground: 34 41 47;

    --muted: 225 228 234;
    --muted-foreground: 108 118 131; /* ojas-slate-gray */

    --accent: 225 228 234;
    --accent-foreground: 34 41 47;

    --destructive: 255 78 78; /* ojas-vibrant-coral */
    --destructive-foreground: 255 255 255;

    --border: 225 228 234; /* ojas-cloud-silver */
    --input: 225 228 234;
    --ring: 0 119 182; /* ojas-primary-blue */

    --radius: 16px; /* 4pt grid aligned */
    
    /* 4pt Base Grid System */
    --grid-4: 4px;
    --grid-8: 8px;
    --grid-12: 12px;
    --grid-16: 16px;
    --grid-20: 20px;
    --grid-24: 24px;
    --grid-32: 32px;
    --grid-44: 44px; /* Minimum touch target */
  }

  /* Fixed Dark Mode Implementation */
  .dark {
    --background: 24 35 58; /* ojas-soft-midnight */
    --foreground: 245 248 250;

    --card: 34 41 47;
    --card-foreground: 245 248 250;

    --popover: 34 41 47;
    --popover-foreground: 245 248 250;

    --primary: 0 119 182;
    --primary-foreground: 255 255 255;

    --secondary: 108 118 131;
    --secondary-foreground: 245 248 250;

    --muted: 108 118 131;
    --muted-foreground: 225 228 234;

    --accent: 108 118 131;
    --accent-foreground: 245 248 250;

    --destructive: 255 78 78;
    --destructive-foreground: 245 248 250;

    --border: 108 118 131;
    --input: 108 118 131;
    --ring: 0 119 182;
  }

  /* Apply dark mode styles properly */
  .dark body {
    background-color: rgb(24 35 58);
    color: rgb(245 248 250);
  }

  .dark .bg-white {
    background-color: rgb(34 41 47) !important;
    color: rgb(245 248 250) !important;
  }

  .dark .text-ojas-charcoal-gray {
    color: rgb(245 248 250) !important;
  }

  .dark .text-ojas-slate-gray {
    color: rgb(225 228 234) !important;
  }

  .dark .border-ojas-cloud-silver {
    border-color: rgb(108 118 131) !important;
  }

  /* High Contrast Mode - Enhanced for WCAG AAA */
  .high-contrast {
    --background: 0 0 0;
    --foreground: 255 255 255;
    --card: 0 0 0;
    --card-foreground: 255 255 255;
    --border: 255 255 255;
    --primary: 255 255 255;
    --primary-foreground: 0 0 0;
  }

  .high-contrast * {
    background-color: black !important;
    color: white !important;
    border-color: white !important;
    font-weight: 700 !important; /* Bold text for high contrast */
  }

  .high-contrast button {
    background-color: white !important;
    color: black !important;
    border: 3px solid white !important;
    font-weight: 900 !important;
  }

  .high-contrast .bg-ojas-primary,
  .high-contrast .bg-ojas-primary-blue {
    background-color: white !important;
    color: black !important;
  }

  /* Large Fonts Mode - Enhanced with proper scaling */
  .large-fonts {
    font-size: 1.25rem !important;
  }

  .large-fonts h1 {
    font-size: 2rem !important; /* 32sp scaled from 24sp */
  }

  .large-fonts h2 {
    font-size: 1.625rem !important; /* 26sp scaled from 20sp */
  }

  .large-fonts h3 {
    font-size: 1.375rem !important; /* 22sp scaled from 18sp */
  }

  .large-fonts button {
    font-size: 1.25rem !important;
    padding: 1rem 1.5rem !important;
    min-height: 56px !important;
  }

  .large-fonts .text-sm {
    font-size: 1rem !important;
  }

  .large-fonts .text-base {
    font-size: 1.25rem !important;
  }
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply bg-ojas-mist-white text-ojas-charcoal-gray font-ojas;
    font-size: 16px; /* Base 16sp */
    line-height: 1.4; /* 1.4em line-height for body text */
  }

  /* Typography Hierarchy - WCAG AA Compliant */
  h1 {
    font-size: 24px; /* 24sp */
    font-weight: 700;
    line-height: 1.2;
    color: rgb(34 41 47); /* 4.5:1+ contrast ratio */
  }

  h2 {
    font-size: 20px; /* 20sp */
    font-weight: 600;
    line-height: 1.25;
    color: rgb(34 41 47);
  }

  h3 {
    font-size: 18px; /* 18sp for section headers */
    font-weight: 600;
    line-height: 1.3;
    color: rgb(34 41 47);
  }

  p, span, div {
    font-size: 16px; /* 16sp body text */
    line-height: 1.4;
  }

  .caption, .text-caption {
    font-size: 12px; /* 12sp caption */
    line-height: 1.3;
  }

  /* Dark mode typography */
  .dark h1, .dark h2, .dark h3 {
    color: rgb(245 248 250); /* High contrast for dark mode */
  }

  /* Enhanced focus indicators for accessibility - WCAG AA */
  *:focus-visible {
    @apply outline-none ring-4 ring-ojas-primary/60 ring-offset-2 ring-offset-background;
  }

  /* Ensure all interactive elements meet 44x44pt minimum touch target */
  button, .tap-target, a[role="button"] {
    min-height: var(--grid-44);
    min-width: var(--grid-44);
  }

  /* Enhanced button accessibility with proper contrast */
  button:focus-visible {
    @apply ring-4 ring-ojas-primary/80 ring-offset-2;
  }

  /* Touch feedback for all interactive elements */
  button, .tap-target {
    border: 2px solid transparent;
    transition: all 0.2s ease-in-out;
  }

  button:hover {
    border-color: currentColor;
    transform: scale(1.02);
  }

  button:active {
    transform: scale(0.98);
    opacity: 0.8;
  }

  /* Reduced motion preferences */
  @media (prefers-reduced-motion: reduce) {
    button:hover, button:active {
      transform: none;
    }
  }
}

@layer components {
  /* 4pt Grid Spacing Classes */
  .space-grid-4 > * + * { margin-top: var(--grid-4); }
  .space-grid-8 > * + * { margin-top: var(--grid-8); }
  .space-grid-12 > * + * { margin-top: var(--grid-12); }
  .space-grid-16 > * + * { margin-top: var(--grid-16); }

  .p-grid-4 { padding: var(--grid-4); }
  .p-grid-8 { padding: var(--grid-8); }
  .p-grid-12 { padding: var(--grid-12); }
  .p-grid-16 { padding: var(--grid-16); }

  .px-grid-16 { 
    padding-left: var(--grid-16); 
    padding-right: var(--grid-16); 
  }

  /* Enhanced card styling with 4pt grid alignment */
  .ojas-card {
    @apply bg-white rounded-2xl shadow-ojas-soft border-2 border-ojas-cloud-silver transition-all duration-300 hover:shadow-ojas-medium;
    padding: var(--grid-16); /* 16pt internal padding */
  }

  .ojas-card.priority-high {
    @apply scale-105 shadow-ojas-medium border-ojas-primary/20;
    animation: pulse-glow 3s ease-in-out infinite;
  }

  /* Enhanced primary action buttons with proper touch targets */
  .ojas-button {
    @apply rounded-2xl font-bold transition-all duration-200 flex items-center justify-center gap-3 shadow-ojas-soft border-2 border-transparent;
    padding: var(--grid-12) var(--grid-16); /* 12pt vertical, 16pt horizontal */
    min-height: var(--grid-44);
    font-size: 16px;
  }

  .ojas-button-primary {
    @apply ojas-button bg-ojas-primary text-white hover:bg-ojas-primary-hover active:scale-95 shadow-ojas-medium border-ojas-primary;
  }

  .ojas-button-success {
    @apply ojas-button bg-ojas-success text-white hover:bg-ojas-success-hover active:scale-95 shadow-ojas-medium border-ojas-success;
  }

  .ojas-button-secondary {
    @apply ojas-button bg-white text-ojas-charcoal-gray hover:bg-gray-50 active:scale-95 border-2 border-ojas-cloud-silver;
  }

  .ojas-button-alert {
    @apply ojas-button bg-ojas-alert text-ojas-text-main hover:bg-ojas-alert-hover active:scale-95 shadow-ojas-medium border-ojas-alert;
  }

  .ojas-button-error {
    @apply ojas-button bg-ojas-error text-white hover:bg-ojas-error-hover active:scale-95 shadow-ojas-medium border-ojas-error;
  }

  /* Fixed Floating Action Button with enhanced accessibility */
  .ojas-fab {
    @apply text-white rounded-full shadow-ojas-strong flex items-center justify-center transition-all duration-200 hover:scale-110 active:scale-95 border-4 border-white;
    width: var(--grid-44);
    height: var(--grid-44);
    position: fixed;
    z-index: 40;
  }

  .ojas-fab:hover {
    filter: drop-shadow(0 6px 16px rgba(0, 119, 182, 0.6));
  }

  .dark .ojas-fab {
    @apply border-ojas-charcoal-gray;
  }

  /* Large, accessible medication action buttons */
  .medication-action-button {
    @apply rounded-2xl font-bold transition-all duration-200 flex items-center justify-center gap-3 active:scale-95 border-2;
    min-height: var(--grid-44);
    padding: var(--grid-12) var(--grid-16);
    font-size: 16px;
  }

  .medication-taken-button {
    @apply medication-action-button bg-ojas-primary text-white hover:bg-ojas-primary-hover shadow-ojas-medium border-ojas-primary;
  }

  .medication-missed-button {
    @apply medication-action-button bg-ojas-alert text-ojas-text-main hover:bg-ojas-alert-hover shadow-ojas-medium border-ojas-alert;
  }

  /* Navigation styling with proper touch targets */
  .ojas-nav {
    @apply fixed bottom-0 left-0 right-0 bg-white border-t border-ojas-border shadow-ojas-strong z-30;
    padding: var(--grid-8) var(--grid-16);
  }

  .ojas-nav-item {
    @apply flex flex-col items-center justify-center transition-all duration-200;
    min-height: var(--grid-44);
    padding: var(--grid-8);
  }

  .ojas-nav-item.active {
    @apply text-ojas-primary;
  }

  .ojas-nav-item:not(.active) {
    @apply text-ojas-text-secondary hover:text-ojas-text-main;
  }

  /* Enhanced input styling with 4pt grid alignment */
  .ojas-input {
    @apply w-full rounded-xl border-2 border-ojas-border bg-white text-ojas-text-main placeholder-ojas-text-secondary focus:outline-none focus:ring-4 focus:ring-ojas-primary/30 focus:border-ojas-primary transition-all duration-200;
    padding: var(--grid-12) var(--grid-16);
    font-size: 16px;
    min-height: var(--grid-44);
  }

  /* Enhanced textarea styling */
  .ojas-textarea {
    @apply ojas-input resize-none;
    min-height: calc(var(--grid-44) * 2.5); /* ~120px */
  }

  /* Skeleton loader for performance */
  .skeleton {
    @apply animate-pulse bg-gray-200 dark:bg-gray-700 rounded;
  }

  .skeleton-text {
    @apply skeleton h-4 w-full mb-2;
  }

  .skeleton-button {
    @apply skeleton h-11 w-24;
  }

  /* Coach mark styling for onboarding */
  .coach-mark {
    @apply absolute z-50 bg-ojas-primary text-white px-4 py-2 rounded-xl shadow-lg text-sm font-medium;
    animation: gentle-bounce 2s ease-in-out infinite;
  }

  .coach-mark::after {
    content: '';
    position: absolute;
    top: 100%;
    left: 50%;
    margin-left: -5px;
    border-width: 5px;
    border-style: solid;
    border-color: rgb(0 119 182) transparent transparent transparent;
  }
}

/* Enhanced animations for better UX */
@keyframes pulse-glow {
  0%, 100% {
    box-shadow: 0 0 20px rgba(0, 119, 182, 0.3);
  }
  50% {
    box-shadow: 0 0 40px rgba(0, 119, 182, 0.6);
  }
}

@keyframes gentle-bounce {
  0%, 20%, 50%, 80%, 100% {
    transform: translateY(0);
  }
  40% {
    transform: translateY(-10px);
  }
  60% {
    transform: translateY(-5px);
  }
}

@keyframes gentle-fade-in {
  0% {
    opacity: 0;
    transform: translateY(20px);
  }
  100% {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes ripple {
  0% {
    transform: scale(0);
    opacity: 1;
  }
  100% {
    transform: scale(4);
    opacity: 0;
  }
}

/* Enhanced scrollbar for better UX */
::-webkit-scrollbar {
  width: var(--grid-12);
}

::-webkit-scrollbar-track {
  background: #F5F8FA;
}

::-webkit-scrollbar-thumb {
  background: #E1E4EA;
  border-radius: 6px;
}

::-webkit-scrollbar-thumb:hover {
  background: #6C7683;
}

/* Dark mode scrollbar */
.dark ::-webkit-scrollbar-track {
  background: rgb(24 35 58);
}

.dark ::-webkit-scrollbar-thumb {
  background: rgb(108 118 131);
}

  /* Reduced motion preferences - both system and manual */
  @media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
    }
    
    .coach-mark {
      animation: none;
    }
  }

  /* Manual reduced motion class when user toggles setting */
  .reduce-motion *,
  .reduce-motion *::before,
  .reduce-motion *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    transform: none !important;
  }
  
  .reduce-motion .coach-mark {
    animation: none;
  }

  .reduce-motion button:hover,
  .reduce-motion button:active {
    transform: none !important;
  }

/* Range input styling for accessibility */
input[type="range"] {
  -webkit-appearance: none;
  appearance: none;
  height: var(--grid-8);
  background: #E1E4EA;
  border-radius: 4px;
}

input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  height: var(--grid-24);
  width: var(--grid-24);
  border-radius: 50%;
  background: #0077B6;
  cursor: pointer;
  border: 2px solid white;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
}

input[type="range"]::-moz-range-thumb {
  height: var(--grid-24);
  width: var(--grid-24);
  border-radius: 50%;
  background: #0077B6;
  cursor: pointer;
  border: 2px solid white;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
}

input[type="range"]:focus {
  outline: none;
}

input[type="range"]:focus::-webkit-slider-thumb {
  box-shadow: 0 0 0 4px rgba(0, 119, 182, 0.3);
}

input[type="range"]:focus::-moz-range-thumb {
  box-shadow: 0 0 0 4px rgba(0, 119, 182, 0.3);
}

/* WCAG AA Color Contrast Utilities */
.contrast-high {
  color: #000000; /* 21:1 contrast ratio */
  background-color: #FFFFFF;
}

.contrast-medium {
  color: #595959; /* 7:1 contrast ratio */
  background-color: #FFFFFF;
}

.contrast-minimum {
  color: #767676; /* 4.5:1 contrast ratio */
  background-color: #FFFFFF;
}

/* Reduced Motion Implementation */
.reduce-motion * {
  animation-duration: 0.01ms !important;
  animation-iteration-count: 1 !important;
  transition-duration: 0.01ms !important;
  scroll-behavior: auto !important;
}

.reduce-motion .animate-wellness-ring {
  animation: none;
}

.reduce-motion .coach-mark {
  animation: none;
}

.reduce-motion .animate-pulse {
  animation: none;
}
